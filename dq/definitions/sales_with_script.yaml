id: "sales_dq_with_script"
label: "Sales DQ avec script personnalisé"
version: "1.0"

context:
  stream: "A"
  project: "P1"
  zone: "raw"
  quarter: "2025Q4"

databases:
  - alias: sales_2024
    dataset: sales_2024

metrics:
  M-001:
    type: missing_rate
    general:
      export: true
    nature:
      name: "Missing Rate - Quantity"
    identification:
      metric_id: "M-001"
    specific:
      dataset: sales_2024
      column: quantity

tests:
  T-001:
    type: interval_check
    nature:
      name: "Interval Check - Missing Rate"
    identification:
      test_id: "T-001"
      control_name: "Missing Rate Control"
      associated_metric_id: "M-001"
    general:
      criticality: high
      on_fail: raise_alert
    specific:
      target_mode: metric_value
      metric_id: "M-001"
      lower: null
      upper: 0.1

scripts:
  - id: "CUSTOM_SCRIPT_001"
    label: "Script DQ personnalisé"
    path: "scripts/example_custom_dq.py"
    enabled: true
    execute_on: "post_dq"
    params:
      threshold: 0.95
      check_coherence: true
