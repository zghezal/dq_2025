id: sales_quality
description: "Contrôles qualité pour les données de ventes"
version: "1.0"

context:
  stream: "A"
  project: "P1"
  zone: "raw"
  quarter: "2025Q4"

datasets:
  sales_data:
    alias: sales_data
    path: null  # sera fourni lors de l'exécution

metrics:
  missing_rate_amount:
    type: missing_rate
    specific:
      dataset: sales_data
      column: amount
  
  missing_rate_customer:
    type: missing_rate
    specific:
      dataset: sales_data
      column: customer_id
  
  missing_rate_date:
    type: missing_rate
    specific:
      dataset: sales_data
      column: date

tests:
  acceptable_missing_amount:
    type: interval_check
    specific:
      metric_id: missing_rate_amount
      target_mode: metric_value
      lower_enabled: true
      lower_value: 0
      upper_enabled: true
      upper_value: 0.1
    description: "Taux de valeurs manquantes acceptable dans amount (<10%)"
  
  acceptable_missing_customer:
    type: interval_check
    specific:
      metric_id: missing_rate_customer
      target_mode: metric_value
      lower_enabled: true
      lower_value: 0
      upper_enabled: true
      upper_value: 0.1
    description: "Taux de valeurs manquantes acceptable dans customer_id (<10%)"
  
  acceptable_missing_date:
    type: interval_check
    specific:
      metric_id: missing_rate_date
      target_mode: metric_value
      lower_enabled: true
      lower_value: 0
      upper_enabled: true
      upper_value: 0.05
    description: "Taux de valeurs manquantes acceptable dans date (<5%)"
